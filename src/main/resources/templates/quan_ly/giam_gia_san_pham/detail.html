<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Đợt giảm giá</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="/assets/images/Shoes6cop.png"/>
    <link rel="stylesheet" href="/assets/css/backend-plugin.min.css">
    <link rel="stylesheet" href="/assets/css/backend.css?v=1.0.0">
    <link rel="stylesheet" href="/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="/assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css">
    <link rel="stylesheet" href="/assets/vendor/remixicon/fonts/remixicon.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-route.min.js"></script>
</head>

<body ng-app="myAngularJs" ng-controller="myController">
<!-- loader Start -->
<div id="loading">
    <div id="loading-center">
    </div>
</div>
<!-- loader END -->
<!-- Wrapper Start -->
<div class="wrapper">
    <div class="iq-sidebar  sidebar-default ">
        <div class="iq-sidebar-logo d-flex align-items-center justify-content-between">
            <a href="../backend/index.html" class="header-logo">
                <img src="/api/read-file-by-img-url/Shoes6cop.png" class="img-fluid rounded-normal light-logo"
                     alt="logo"><h5 class="logo-title light-logo ml-3">SHOES 6</h5>
            </a>
            <div class="iq-menu-bt-sidebar ml-0">
                <i class="las la-bars wrapper-menu"></i>
            </div>
        </div>
        <div class="data-scrollbar" data-scroll="1">
            <nav class="iq-sidebar-menu">
                <ul id="iq-sidebar-toggle" class="iq-menu">
                    <li class="">
                        <a href="/admin/thong-ke/index" class="svg-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                 class="bi bi-speedometer2" viewBox="0 0 16 16">
                                <path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4M3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707M2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10m9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5m.754-4.246a.39.39 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.39.39 0 0 0-.029-.518z"/>
                                <path fill-rule="evenodd"
                                      d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A8 8 0 0 1 0 10m8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3"/>
                            </svg>
                            <span class="ml-4">Thống kê</span>
                        </a>
                    </li>
                    <li class="">
                        <a href="/ban-hang-tai-quay" class="svg-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                 class="bi bi-cash-stack" viewBox="0 0 16 16">
                                <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
                                <path d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2z"/>
                            </svg>
                            <span class="ml-4">Bán hàng tại quầy</span>
                        </a>
                    </li>
                    <li class="">
                        <a href="/hoa-don/hien-thi" class="svg-icon">
                            <svg class="svg-icon" id="p-dash7" width="20" height="20" xmlns="http://www.w3.org/2000/svg"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            <span class="ml-4">Quản lý đơn hàng</span>
                        </a>
                    </li>
                    <li class=" ">
                        <a href="#product" class="collapsed" data-toggle="collapse" aria-expanded="false">
                            <svg class="svg-icon" id="p-dash2" width="20" height="20" xmlns="http://www.w3.org/2000/svg"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="9" cy="21" r="1"></circle>
                                <circle cx="20" cy="21" r="1"></circle>
                                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                            </svg>
                            <span class="ml-4">Quản lý sản phẩm</span>
                            <svg class="svg-icon iq-arrow-right arrow-active" width="20" height="20"
                                 xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="10 15 15 20 20 15"></polyline>
                                <path d="M4 4h7a4 4 0 0 1 4 4v12"></path>
                            </svg>
                        </a>
                        <ul id="product" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                            <li class="">
                                <a href="/admin/san-pham/index">
                                    <i class="las la-minus"></i><span>Sản phẩm</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/admin/de-giay/index-de-giay">
                                    <i class="las la-minus"></i><span>Đế giày</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/admin/loai-giay/index-loai-giay">
                                    <i class="las la-minus"></i><span>Loại giày</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/admin/thuong-hieu/index-thuong-hieu">
                                    <i class="las la-minus"></i><span>Thương hiệu</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/admin/chat-lieu/index-chat-lieu">
                                    <i class="las la-minus"></i><span>Chất liệu</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/admin/kich-co/index-kich-co">
                                    <i class="las la-minus"></i><span>Kích cỡ</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/admin/mau-sac/index-mau-sac">
                                    <i class="las la-minus"></i><span>Màu sắc</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class=" ">
                        <a href="#category" class="collapsed" data-toggle="collapse" aria-expanded="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                 class="bi bi-ticket-perforated" viewBox="0 0 16 16">
                                <path d="M4 4.85v.9h1v-.9zm7 0v.9h1v-.9zm-7 1.8v.9h1v-.9zm7 0v.9h1v-.9zm-7 1.8v.9h1v-.9zm7 0v.9h1v-.9zm-7 1.8v.9h1v-.9zm7 0v.9h1v-.9z"/>
                                <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3zM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9z"/>
                            </svg>
                            <span class="ml-4">Giảm giá</span>
                            <svg class="svg-icon iq-arrow-right arrow-active" width="20" height="20"
                                 xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="10 15 15 20 20 15"></polyline>
                                <path d="M4 4h7a4 4 0 0 1 4 4v12"></path>
                            </svg>
                        </a>
                        <ul id="category" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                            <li class="">
                                <a href="/admin/giam-gia-san-pham/index">
                                    <i class="las la-minus"></i><span>Đợt giảm giá</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/admin/phieu-giam-gia/index">
                                    <i class="las la-minus"></i><span>Phiếu giảm giá</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class=" ">
                        <a href="#category2" class="collapsed" data-toggle="collapse" aria-expanded="false">
                            <svg class="svg-icon" id="p-dash8" width="20" height="20" xmlns="http://www.w3.org/2000/svg"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            <span class="ml-4">Tài khoản</span>
                            <svg class="svg-icon iq-arrow-right arrow-active" width="20" height="20"
                                 xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="10 15 15 20 20 15"></polyline>
                                <path d="M4 4h7a4 4 0 0 1 4 4v12"></path>
                            </svg>
                        </a>
                        <ul id="category2" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                            <li class="">
                                <a href="/admin/nhan-vien/index">
                                    <i class="las la-minus"></i><span>Nhân viên</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="/tai-khoan/index">
                                    <i class="las la-minus"></i><span>Khách hàng</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <div class="p-3"></div>
        </div>
    </div>
    <div class="iq-top-navbar">
        <div class="iq-navbar-custom">
            <nav class="navbar navbar-expand-lg navbar-light p-0">
                <div class="iq-navbar-logo d-flex align-items-center justify-content-between">
                    <i class="ri-menu-line wrapper-menu"></i>
                    <a href="../backend/index.html" class="header-logo">
                        <img src="/api/read-file-by-img-url/Shoes6cop.png" class="img-fluid rounded-normal" alt="logo">
                        <h5 class="logo-title ml-3">SHOES 6</h5>

                    </a>
                </div>
                <div class="d-flex align-items-center">
                    <button class="navbar-toggler" type="button" data-toggle="collapse"
                            data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                            aria-label="Toggle navigation">
                        <i class="ri-menu-3-line"></i>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ml-auto navbar-list align-items-center">
                            <li class="nav-item nav-icon search-content">
                                <a href="#" class="search-toggle rounded" id="dropdownSearch" data-toggle="dropdown"
                                   aria-haspopup="true" aria-expanded="false">
                                    <i class="ri-search-line"></i>
                                </a>
                                <div class="iq-search-bar iq-sub-dropdown dropdown-menu"
                                     aria-labelledby="dropdownSearch">
                                    <form action="#" class="searchbox p-2">
                                        <div class="form-group mb-0 position-relative">
                                            <input type="text" class="text search-input font-size-12"
                                                   placeholder="type here to search...">
                                            <a href="#" class="search-link"><i class="las la-search"></i></a>
                                        </div>
                                    </form>
                                </div>
                            </li>
                            <li class="nav-item nav-icon dropdown caption-content">
                                <a href="#" class="search-toggle dropdown-toggle" id="dropdownMenuButton4"
                                   data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <img src="/api/read-file-by-id-tai-khoan/{{taiKhoan.id}}" class="img-fluid rounded"
                                         alt="user">
                                </a>
                                <div class="iq-sub-dropdown dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <div class="card shadow-none m-0">
                                        <div class="card-body p-0 text-center">
                                            <div class="media-body profile-detail text-center">
                                                <img src="/api/read-file-by-img-url/modern-sports-shoe-design-abstract-motion-generated-by-ai.jpg"
                                                     alt="profile-bg"
                                                     class="rounded-top img-fluid mb-4">
                                                <img src="/api/read-file-by-id-tai-khoan/{{taiKhoan.id}}"
                                                     alt="profile-img"
                                                     class="rounded profile-img img-fluid avatar-70">
                                            </div>
                                            <div class="p-3">
                                                <h5 class="mb-1">{{taiKhoan.email}}</h5>
                                                <p class="mb-0">{{taiKhoan.hoVaTen}}</p>
                                                <div class="d-flex align-items-center justify-content-center mt-3">
                                                    <a href="/tai-khoan-quan-ly/ho-so" class="btn border mr-2">Thông
                                                        tin</a>
                                                    <a href="/logout" class="btn border">Đăng xuất</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </div>
    <div class="content-page">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-lg-12">
                    <div class="d-flex flex-wrap align-items-center justify-content-between">
                        <div>
                            <h4 class="mb-3">Cập nhật đợt giảm giá</h4>
                        </div>
                    </div>
                </div>
            </div>

            <form onsubmit="handleSubmit(event)" id="myForm" th:action="@{|/admin/giam-gia-san-pham/update/${idGgsp}|}"
                  method="post"
                  th:object="${ggspUpdate}">
                <div class="row">
                    <div th:if="${checkAdd==false}" th:text="${ngay}" class="alert alert-danger"
                         role="alert"></div>
                    <div class="col-5">
                        <div class="mb-3">
                            <label class="form-label">Tên đợt giảm giá</label>
                            <input type="text" class="form-control" id="ten" th:field="*{ten}">
                            <i th:errors="*{ten}" style="color: red"></i>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Giá trị</label>
                            <input type="number" class="form-control" id="giaTri" th:field="*{giaTri}">
                            <i th:errors="*{giaTri}" style="color: red"></i>
                            <i th:if="${checkGt==false}" th:text="${gt}" style="color: red"></i>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Từ ngày</label>
                            <input type="datetime-local" id="ngayBatDau" class="form-control"
                                   th:field="*{ngayBatDau}" onchange="updateMinDate()">
                            <i th:errors="*{ngayBatDau}" style="color: red"></i>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Đến ngày</label>
                            <input type="datetime-local" id="ngayKetThuc" class="form-control"
                                   onchange="updateMaxDate()"
                                   th:field="*{ngayKetThuc}">
                            <i th:errors="*{ngayKetThuc}" style="color: red"></i>
                        </div>
                    </div>

                    <div class="col-7" id="myDiv">
                        <div class="input-group mb-4">
                            <div class="input-group-prepend">
                                <button class="btn btn-success my-2 my-sm-0" type="button" onclick="submitData()"><i
                                        class="ri-search-2-line"></i></button>
                            </div>
                            <input class="form-control mr-sm-2" type="search"
                                   placeholder="Nhập tên sản phẩm cần tìm"
                                   id="tenSp" th:name="tenSp" th:value="${tenSp}"
                                   aria-label="Search">
                        </div>
                        <div class="table-responsive rounded mb-3">
                            <table class="data-table table mb-0 tbl-server-info">
                                <thead class="bg-white text-uppercase">
                                <tr class="ligth ligth-data">
                                    <th></th>
                                    <th>STT</th>
                                    <th>Tên</th>
                                </tr>
                                </thead>
                                <tbody class="ligth-body">
                                <tr th:each="i,lstSP:${lstSp}">
                                    <td>
                                        <div class="form-check">
                                            <input class="select-item" type="checkbox"
                                                   onchange="handleCheckboxSelection(this)"
                                                   th:value="${i.id}"
                                                   id="idSp"
                                                   name="checkboxValues"
                                            >
                                        </div>
                                    </td>
                                    <td th:text="${(lstSp.number * 5) + lstSP.index + 1}"></td>
                                    <td th:text="${i.tenSanPham}"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="pagination-container">
                            <nav aria-label="Page navigation example">
                                <ul class="pagination">
                                    <li class="page-item"><a
                                            class="page-link" onclick="previousPage()">Previous</a>
                                    </li>
                                    <li class="page-item"><a class="page-link" th:text="${lstSp.number+1}"></a></li>
                                    <li class="page-item"><a class="page-link" onclick="nextPage()">Next</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                <div th:if="${checkboxValues!=null}">
                    <div class="row mb-3">
                        <div class="col-lg-12">
                            <div class="d-flex flex-wrap align-items-center justify-content-between">
                                <div>
                                    <h4 class="mb-3">Chi tiết sản phẩm</h4>
                                </div>
                                <button type="submit" class="btn btn-warning add-list">
                                    <i class="ri-pencil-line mr-3"></i> Cập nhật
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3 d-flex align-content-center justify-content-start">
                        <div class="input-group input-group-sm col-2 col-lg-2">
                            <div class="input-group-prepend">
                                <label class="input-group-text bg-teal">
                                    <strong>Màu sắc</strong>
                                </label>
                            </div>
                            <select class="form-control form-control-sm"
                                    id="mauSac">
                                <option value="0">Tất cả</option>
                                <option th:each="i,lstMS:${lstMauSac}" th:value="${i.id}"
                                        th:text="${i.tenMauSac}"></option>
                            </select>
                        </div>
                        <div class="input-group input-group-sm col-2 col-lg-2">
                            <div class="input-group-prepend">
                                <label class="input-group-text bg-teal">
                                    <strong>Chất liệu</strong>
                                </label>
                            </div>
                            <select class="form-control form-control-sm"
                                    id="chatLieu">
                                <option th:value="0">Tất cả</option>
                                <option th:each="i,lstCL:${lstChatLieu}" th:value="${i.id}"
                                        th:text="${i.tenChatLieu}"></option>
                            </select>
                        </div>
                        <div class="input-group input-group-sm col-2 col-lg-2">
                            <div class="input-group-prepend">
                                <label class="input-group-text bg-teal">
                                    <strong>Kích cỡ</strong>
                                </label>
                            </div>
                            <select class="form-control form-control-sm"
                                    id="kichCo">
                                <option th:value="0">Tất cả</option>
                                <option th:each="i,lstKC:${lstKichCo}" th:value="${i.id}"
                                        th:text="${i.tenKichThuoc}"></option>
                            </select>
                        </div>
                        <div class="input-group input-group-sm col-2 col-lg-2">
                            <div class="input-group-prepend">
                                <label class="input-group-text bg-teal">
                                    <strong>Đế giày</strong>
                                </label>
                            </div>
                            <select class="form-control form-control-sm"
                                    id="deGiay">
                                <option th:value="0">Tất cả</option>
                                <option th:each="i,lstDG:${lstDeGiay}" th:value="${i.id}"
                                        th:text="${i.tenDeGiay}"></option>
                            </select>
                        </div>
                        <div class="input-group input-group-sm col-2 col-lg-2">
                            <div class="input-group-prepend">
                                <label class="input-group-text bg-teal">
                                    <strong>Thương hiệu</strong>
                                </label>
                            </div>
                            <select class="form-control form-control-sm"
                                    id="thuongHieu">
                                <option th:value="0">Tất cả</option>
                                <option th:each="i,lstTH:${lstThuongHieu}" th:value="${i.id}"
                                        th:text="${i.tenThuongHieu}"></option>
                            </select>
                        </div>
                        <div class="col-2 col-lg-2 d-flex align-content-center justify-content-center">
                            <button onclick="loc()" type="button" class="btn btn-outline-success btn-sm">
                                <i class="ri-filter-line"></i>
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive rounded mb-3">
                        <table class="data-table table mb-0 tbl-server-info">
                            <thead class="bg-white text-uppercase">
                            <tr class="ligth ligth-data">
                                <th></th>
                                <th>STT</th>
                                <th>Ảnh</th>
                                <th>Tên sản phẩm</th>
                                <th>Thể loại</th>
                                <th>Thương hiệu</th>
                                <th>Chất liệu</th>
                                <th>Màu sắc</th>
                                <th>Đế giày</th>
                                <th>Kích thước</th>
                            </tr>
                            </thead>
                            <tbody class="ligth-body">
                            <tr th:each="i,lstSPCT:${lstSpct}">
                                <td>
                                    <div class="form-check">
                                        <input class="select-item" type="checkbox"
                                               onchange="handleCheckboxSelectionSpct(this)"
                                               th:value="${i.id}"
                                               id="idSpct"
                                               name="checkboxValuesSpct">
                                    </div>
                                </td>
                                <td th:text="${(lstSpct.number * 5) + lstSPCT.index + 1}"></td>
                                <td >
                                    <img class="avatar-70 rounded"
                                         th:src="@{'/api/read-file-by-idspct-return-anh-mac-dinh/' + ${i.id}}"
                                         alt="Không có ảnh">
                                </td>
                                <td th:text="${i.sanPhamByIdSanPham.tenSanPham}"></td>
                                <td th:text="${i.theLoaiByIdDanhMuc.tenTheLoai}"></td>
                                <td th:text="${i.thuongHieuByIdThuongHieu.tenThuongHieu}"></td>
                                <td th:text="${i.chatLieuByIdChatLieu.tenChatLieu}"></td>
                                <td th:text="${i.mauSacByIdMauSac.tenMauSac}"></td>
                                <td th:text="${i.deGiayByIdDeGiay.tenDeGiay}"></td>
                                <td th:text="${i.kichThuocByIdKichCo.tenKichThuoc}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="row mb-3">
                        <div class="col-lg-12 col-12 d-flex flex-wrap align-content-center justify-content-between">
                            <nav aria-label="Page navigation example">
                                <ul class="pagination">
                                    <li class="page-item"><a
                                            class="page-link"
                                            onclick="previousPageSpct()">Previous</a>
                                    </li>
                                    <li class="page-item"><a class="page-link" th:text="${lstSpct.number+1}"></a></li>
                                    <li class="page-item"><a class="page-link" onclick="nextPageSpct()">Next</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </form>

                <div class="row mb-3">
                    <div class="col-lg-12">
                        <div class="d-flex flex-wrap align-items-center justify-content-between">
                            <div>
                                <h4 class="mb-3">Danh sách sản phẩm giảm giá</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="table-responsive rounded mb-3">
                    <table class="data-table table mb-0 tbl-server-info">
                        <thead class="bg-white text-uppercase">
                        <tr class="ligth ligth-data">
                            <th>STT</th>
                            <th>Ảnh</th>
                            <th>Tên sản phẩm</th>
                            <th>Thể loại</th>
                            <th>Thương hiệu</th>
                            <th>Chất liệu</th>
                            <th>Màu sắc</th>
                            <th>Đế giày</th>
                            <th>Kích thước</th>
                            <th>Trạng thái</th>
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody class="ligth-body">
                        <tr th:each="i,lstSPCT:${lstGgspctByIdGgsp}">
                            <td th:text="${ lstSPCT.index + 1}"></td>
                            <td>
                                <img class="avatar-70 rounded"
                                     th:src="@{'/api/read-file-by-idspct-return-anh-mac-dinh/' + ${i.sanPhamChiTietByIdSpct.id}}"
                                     alt="Không có ảnh">
                            </td>
                            <td th:text="${i.sanPhamChiTietByIdSpct.sanPhamByIdSanPham.tenSanPham}"></td>
                            <td th:text="${i.sanPhamChiTietByIdSpct.theLoaiByIdDanhMuc.tenTheLoai}"></td>
                            <td th:text="${i.sanPhamChiTietByIdSpct.thuongHieuByIdThuongHieu.tenThuongHieu}"></td>
                            <td th:text="${i.sanPhamChiTietByIdSpct.chatLieuByIdChatLieu.tenChatLieu}"></td>
                            <td th:text="${i.sanPhamChiTietByIdSpct.mauSacByIdMauSac.tenMauSac}"></td>
                            <td th:text="${i.sanPhamChiTietByIdSpct.deGiayByIdDeGiay.tenDeGiay}"></td>
                            <td th:text="${i.sanPhamChiTietByIdSpct.kichThuocByIdKichCo.tenKichThuoc}"></td>
                            <td th:if="${i.trangThai==1}">
                                <div class="badge badge-success"
                                     th:text="${i.getTT(i.trangThai)}"></div>
                            </td>
                            <td th:if="${i.trangThai==0}">
                                <div class="badge badge-danger"
                                     th:text="${i.getTT(i.trangThai)}"></div>
                            </td>
                            <td th:if="${i.trangThai==2}">
                                <div class="badge badge-warning"
                                     th:text="${i.getTT(i.trangThai)}"></div>
                            </td>
                            <td th:if="${i.trangThai==3}">
                                <div class="badge badge-secondary"
                                     th:text="${i.getTT(i.trangThai)}"></div>
                            </td>
                            <td>
                                <a th:href="@{|/admin/giam-gia-san-pham/update-trang-thai-ggsp-sp/${i.id}|}"
                                   class="badge bg-warning mr-2"
                                   data-toggle="tooltip" data-placement="top" title=""
                                   data-original-title="Chuyển trạng thái"><i class="ri-shuffle-line mr-0"></i></a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

        </div>
    </div>
</div>
<!-- Wrapper End-->
<footer class="iq-footer">
    <div class="container-fluid">
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-6">
                        <ul class="list-inline mb-0">
                            <li class="list-inline-item"><a href="#">Chính sách bảo mật</a></li>
                            <li class="list-inline-item"><a href="#">Điều khoản</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-6 text-right">
                        <span class="mr-1">2024©</span> <a href="#" class="">SHOES 6</a>.
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
</body>
<script src="/assets/js/backend-bundle.min.js"></script>
<script src="/assets/js/table-treeview.js"></script>
<script src="/assets/js/customizer.js"></script>
<script async="" src="/assets/js/chart-custom.js"></script>
<script src="/assets/js/app.js"></script>
<script>
    let myApp = angular.module("myAngularJs", ['ngRoute']);
    myApp.controller("myController", myFunction);

    function myFunction($scope, $http) {
        $http.get("/api/khach-hang/trang-chu/get-tai-khoan")
            .then(function (res) {
                if (res.status == 200) {
                    $scope.taiKhoan = res.data
                    if ($scope.taiKhoan == '') {
                        $scope.taiKhoan = null
                    }
                    return $scope.taiKhoan
                }
            })
    }

    var id = [[${idGgsp}]]

    /**
     * Load lại các giá trị vào ô checked
     */
    window.onload = function () {
        console.log(id)
        const urlParams = new URLSearchParams(window.location.search);
        const checkboxValues = urlParams.getAll('checkboxValues');
        checkboxValues.forEach(value => {
            let checkbox = document.querySelector(`input[name="checkboxValues"][value="${value}"]`);
            if (checkbox) {
                checkbox.checked = true;
            }
        });

        // Lấy dữ liệu từ localStorage
        let storedValues = localStorage.getItem('checkboxValues');
        if (storedValues) {
            let values = JSON.parse(storedValues);
            values.forEach(value => {
                let checkbox = document.querySelector(`input[name="checkboxValues"][value="${value}"]`);
                if (checkbox) {
                    checkbox.checked = true;
                }
            });
        }

        // Kiểm tra nếu URL không chứa tham số 'page' hoặc 'checkboxValues', thì xóa localStorage
        if (window.location.pathname != '/admin/giam-gia-san-pham/detail-search/[[${idGgsp}]]' && window.location.pathname != '/admin/giam-gia-san-pham/detail/[[${idGgsp}]]' && window.location.pathname != '/admin/giam-gia-san-pham/update/[[${idGgsp}]]' && window.location.pathname != '/admin/giam-gia-san-pham/detail-loc/[[${idGgsp}]]') {
            localStorage.removeItem('checkboxValues');
            let checkboxes = document.querySelectorAll('input[name="checkboxValues"]');
            checkboxes.forEach((checkbox) => {
                checkbox.checked = false;
            });

            localStorage.removeItem('checkboxValuesSpct');
            let checkboxesSpct = document.querySelectorAll('input[name="checkboxValuesSpct"]');
            checkboxesSpct.forEach((checkbox) => {
                checkbox.checked = false;
            });
        }

        /**
         * checkbox spct còn chưa hoàn thành nha
         */
        const urlParams2 = new URLSearchParams(window.location.search);
        const checkboxValues2 = urlParams2.getAll('checkboxValuesSpct');
        checkboxValues2.forEach(value => {
            let checkbox = document.querySelector(`input[name="checkboxValuesSpct"][value="${value}"]`);
            if (checkbox) {
                checkbox.checked = true;
            }
        });

        // Lấy dữ liệu từ localStorage
        let storedValues2 = localStorage.getItem('checkboxValuesSpct');
        if (storedValues2) {
            let values = JSON.parse(storedValues2);
            values.forEach(value => {
                let checkbox = document.querySelector(`input[name="checkboxValuesSpct"][value="${value}"]`);
                if (checkbox) {
                    checkbox.checked = true;
                }
            });
        }

    }


    function handleCheckboxSelectionSpct(checkbox) {

        let storedValues = localStorage.getItem('checkboxValuesSpct');
        let values = storedValues ? JSON.parse(storedValues) : [];

        if (checkbox.checked && !values.includes(checkbox.value)) {
            values.push(checkbox.value);
        } else if (!checkbox.checked) {
            values = values.filter(value => value !== checkbox.value);
        }

        localStorage.setItem('checkboxValuesSpct', JSON.stringify(values));
        updateURLWithCheckboxValues(values);
    }

    function updateURLWithCheckboxValues(values) {
        const urlParams = new URLSearchParams(window.location.search);
        let currentPage = parseInt(urlParams.get('page')) || 0;
        let currentPageSpct = parseInt(urlParams.get('pageCtsp')) || 0;
        let tenSp = urlParams.get('tenSp') || '';

        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');
        queryString += values.map(value => 'checkboxValuesSpct=' + encodeURIComponent(value)).join('&');
        queryString += `&page=${currentPage}&pageCtsp=${currentPageSpct}`;

        let url;
        if (!tenSp) {
            url = '/admin/giam-gia-san-pham/detail/' + [[${idGgsp}]] + '?' + queryString;
        } else {
            url = '/admin/giam-gia-san-pham/detail-search/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        }

        window.history.replaceState(null, null, url);
    }

    /**
     * Tích chọn các ô của sản phẩm
     */
    function handleCheckboxSelection(checkbox) {
        let storedValuesSpct = localStorage.getItem('checkboxValuesSpct');
        let valuesSpct = storedValuesSpct ? JSON.parse(storedValuesSpct) : [];
        let lstIdSpct = [[${lstIdSpct}]]
        let stringArrayLstIdSpct = lstIdSpct.map(number => number.toString());
        let filteredArray = stringArrayLstIdSpct.filter(element => valuesSpct.includes(element));
        localStorage.setItem('checkboxValuesSpct', JSON.stringify(filteredArray));

        // Lấy các giá trị checkbox đã lưu trong localStorage (nếu có)
        let storedValues = localStorage.getItem('checkboxValues');
        let values = storedValues ? JSON.parse(storedValues) : [];


        // Nếu checkbox được chọn, thêm giá trị vào mảng nếu chưa có
        if (checkbox.checked && !values.includes(checkbox.value)) {
            values.push(checkbox.value);
        } else if (!checkbox.checked) { // Nếu checkbox bị bỏ chọn, loại bỏ giá trị khỏi mảng
            values = values.filter(value => value !== checkbox.value);
        }

        // Lưu lại mảng giá trị vào localStorage
        localStorage.setItem('checkboxValues', JSON.stringify(values));


        const urlParams = new URLSearchParams(window.location.search);
        let currentPage = parseInt(urlParams.get('page')) || 0;
        let currentPageSpct = parseInt(urlParams.get('pageCtsp')) || 0;

        let tenSp = urlParams.get('tenSp') || '';

        // Xây dựng URL với các tham số truy vấn và thêm 'page'
        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');
        queryString += `&page=${currentPage}`;
        queryString += `&pageCtsp=${currentPageSpct}`;
        let url;
        if (typeof tenSp == 'undefined' || tenSp.trim() == "" || tenSp == null) {
            url = '/admin/giam-gia-san-pham/detail/' + [[${idGgsp}]] + '?' + queryString;
        } else {
            url = '/admin/giam-gia-san-pham/detail-search/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        }

        // Chuyển đến trang tiếp theo
        window.location.href = url;
    }

    /**
     * Next page Sản phẩm
     */
    function nextPage() {
        // Lấy dữ liệu từ localStorage
        let storedValues = localStorage.getItem('checkboxValues');
        let values = storedValues ? JSON.parse(storedValues) : [];

        let maxPage = [[${lstSp.totalPages}]];

        // Lấy tham số 'page' hiện tại hoặc đặt mặc định là 0
        const urlParams = new URLSearchParams(window.location.search);
        let tenSp = urlParams.get('tenSp') || '';
        let currentPage = parseInt(urlParams.get('page')) || 0;
        let currentPageSpct = parseInt(urlParams.get('pageCtsp')) || 0;
        let nextPage;
        // Tăng giá trị của 'page'
        if (currentPage < maxPage - 1) {
            nextPage = currentPage + 1
        }
        if (currentPage == maxPage - 1) {
            nextPage = 0
        }

        // Xây dựng URL với các tham số truy vấn và thêm 'page'
        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');
        queryString += `&page=${nextPage}`;
        queryString += `&pageCtsp=${currentPageSpct}`;
        let url;

        if (typeof tenSp == 'undefined' || tenSp.trim() == "" || tenSp == null) {
            url = '/admin/giam-gia-san-pham/detail/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        } else {
            url = '/admin/giam-gia-san-pham/detail-search/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        }
        // Chuyển đến trang tiếp theo
        window.location.href = url;
    }

    /**
     * Previous page Sản phẩm
     */
    function previousPage() {
        let storedValues = localStorage.getItem('checkboxValues');
        let values = storedValues ? JSON.parse(storedValues) : [];

        // Lấy tham số 'page' hiện tại hoặc đặt mặc định là 0
        const urlParams = new URLSearchParams(window.location.search);
        let tenSp = urlParams.get('tenSp') || '';
        let currentPage = parseInt(urlParams.get('page')) || 0;
        let currentPageSpct = parseInt(urlParams.get('pageCtsp')) || 0;

        let previousPage;

        if (currentPage > 0) {
            previousPage = currentPage - 1;
        }
        if (currentPage == 0) {
            previousPage = [[${lstSp.totalPages}]] - 1;
        }

        // Xây dựng URL với các tham số truy vấn và thêm 'page'
        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');
        queryString += `&page=${previousPage}`;
        queryString += `&pageCtsp=${currentPageSpct}`;
        let url;

        if (typeof tenSp == 'undefined' || tenSp.trim() == "" || tenSp == null) {
            url = '/admin/giam-gia-san-pham/detail/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        } else {
            url = '/admin/giam-gia-san-pham/detail-search/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        }
        // Chuyển đến trang tiếp theo
        window.location.href = url;
    }

    // Hàm kiểm tra lstSpct.totalPages có giá trị hay không

    /**
     * Next page Sản phẩm Chi tiết
     */

    function nextPageSpct() {
        // Lấy dữ liệu từ localStorage
        let storedValues = localStorage.getItem('checkboxValues');
        let values = storedValues ? JSON.parse(storedValues) : [];

        let maxPageSpct = [[${lstSpct.totalPages}]];

        // Lấy tham số 'page' hiện tại hoặc đặt mặc định là 0
        const urlParams = new URLSearchParams(window.location.search);
        let tenSp = urlParams.get('tenSp') || '';
        let currentPage = parseInt(urlParams.get('page')) || 0;
        let currentPageSpct = parseInt(urlParams.get('pageCtsp')) || 0;
        let nextPageSpct;
        // Tăng giá trị của 'page'
        if (currentPageSpct < maxPageSpct - 1) {
            nextPageSpct = currentPageSpct + 1
        }
        if (currentPageSpct == maxPageSpct - 1) {
            nextPageSpct = 0
        }

        // Xây dựng URL với các tham số truy vấn và thêm 'page'
        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');
        queryString += `&page=${currentPage}&pageCtsp=${nextPageSpct}`;
        let url;

        if (typeof tenSp == 'undefined' || tenSp.trim() == "" || tenSp == null) {
            url = '/admin/giam-gia-san-pham/detail/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        } else {
            url = '/admin/giam-gia-san-pham/detail-search/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        }
        // Chuyển đến trang tiếp theo
        window.location.href = url;
    }

    /**
     * Previous page Sản phẩm chi tiết
     */
    function previousPageSpct() {
        let storedValues = localStorage.getItem('checkboxValues');
        let values = storedValues ? JSON.parse(storedValues) : [];

        // Lấy tham số 'page' hiện tại hoặc đặt mặc định là 0
        const urlParams = new URLSearchParams(window.location.search);
        let tenSp = urlParams.get('tenSp') || '';
        let currentPage = parseInt(urlParams.get('page')) || 0;
        let currentPageSpct = parseInt(urlParams.get('pageCtsp')) || 0;

        let previousPage;

        if (currentPageSpct > 0) {
            previousPage = currentPageSpct - 1;
        }
        if (currentPageSpct == 0) {
            previousPage = [[${lstSpct.totalPages}]] - 1;
        }

        // Xây dựng URL với các tham số truy vấn và thêm 'page'
        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');
        queryString += `&page=${currentPage}`;
        queryString += `&pageCtsp=${previousPage}`;
        let url;

        if (typeof tenSp == 'undefined' || tenSp.trim() == "" || tenSp == null) {
            url = '/admin/giam-gia-san-pham/detail/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        } else {
            url = '/admin/giam-gia-san-pham/detail-search/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        }
        window.location.href = url;
    }

    function submitData() {

        var tenSp = "";
        tenSp = document.getElementById('tenSp').value

        let storedValues = localStorage.getItem('checkboxValues');
        let values = storedValues ? JSON.parse(storedValues) : [];
        localStorage.setItem('checkboxValues', JSON.stringify(values));

        const urlParams = new URLSearchParams(window.location.search);
        let currentPage = 0;

        // Xây dựng URL với các tham số truy vấn và thêm 'page'
        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');
        queryString += `&page=${currentPage}`;
        let url;

        if (typeof tenSp == 'undefined' || tenSp.trim() == "" || tenSp == null) {
            url = '/admin/giam-gia-san-pham/detail/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        } else {
            url = '/admin/giam-gia-san-pham/detail-search/' + [[${idGgsp}]] + '?' + queryString + '&tenSp=' + tenSp;
        }

        // Chuyển đến trang tiếp theo
        window.location.href = url;
    }

    function loc() {
        var mauSac = "";
        var chatLieu = "";
        var kichCo = "";
        var deGiay = "";
        var thuongHieu = "";
        mauSac = document.getElementById('mauSac').value
        chatLieu = document.getElementById('chatLieu').value
        kichCo = document.getElementById('kichCo').value
        deGiay = document.getElementById('deGiay').value
        thuongHieu = document.getElementById('thuongHieu').value

        let storedValues = localStorage.getItem('checkboxValues');
        let values = storedValues ? JSON.parse(storedValues) : [];

        let queryString = values.map(value => 'checkboxValues=' + encodeURIComponent(value)).join('&');

        // Sử dụng window.location.href để chuyển hướng đến controller với tham số sdt
        window.location.href = '/admin/giam-gia-san-pham/detail-loc/' + [[${idGgsp}]] + '?' + 'mauSac=' + encodeURIComponent(mauSac) + "&" + 'chatLieu=' + encodeURIComponent(chatLieu) + "&" + 'kichCo=' + encodeURIComponent(kichCo) + "&" + 'deGiay=' + encodeURIComponent(deGiay) + "&" + 'thuongHieu=' + encodeURIComponent(thuongHieu) + "&" + queryString;
    }

    function updateMinDate() {
        // Lấy giá trị của trường ngày bắt đầu
        const startDate = document.getElementById('ngayBatDau').value;

        // Lấy trường ngày kết thúc
        const endDateInput = document.getElementById('ngayKetThuc');

        if (startDate) {
            // Cập nhật thuộc tính min của trường ngày kết thúc
            endDateInput.setAttribute('min', startDate);

            // Nếu ngày kết thúc đã được chọn và nhỏ hơn ngày bắt đầu, xóa giá trị ngày kết thúc
            if (endDateInput.value && endDateInput.value < startDate) {
                endDateInput.value = '';
            }
        } else {
            // Nếu không có ngày bắt đầu, xóa thuộc tính min
            endDateInput.removeAttribute('min');
        }
    }

    function updateMaxDate() {
        // Lấy giá trị của trường ngày kết thúc
        const endDate = document.getElementById('ngayKetThuc').value;

        // Lấy trường ngày bắt đầu
        const startDateInput = document.getElementById('ngayBatDau');

        if (startDateInput) {
            // Cập nhật thuộc tính max của trường ngày bắt đầu với giá trị của ngày kết thúc
            startDateInput.setAttribute('max', endDate);

            // Nếu ngày bắt đầu đã được chọn và lớn hơn ngày kết thúc, xóa giá trị ngày bắt đầu
            if (startDateInput.value && startDateInput.value > endDate) {
                startDateInput.value = '';
            }
        } else {
            // Nếu không có trường ngày bắt đầu, không làm gì cả hoặc có thể thêm logic khác
            console.log('Phần tử ngày bắt đầu không tồn tại.');
        }
    }

    // document.addEventListener('contextmenu', function (e) {
    //     e.preventDefault(); // Ngăn chuột phải
    // });
    //
    // document.addEventListener('keydown', function (e) {
    //     if (e.keyCode === 123) {
    //         e.preventDefault();
    //     }
    // });

    function handleSubmit(event) {
        event.preventDefault(); // Ngăn chặn submit mặc định của form

        // Hiển thị Swal để xác nhận
        Swal.fire({
            title: 'Bạn có muốn thêm đợt giảm giá?',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Xác nhận',
            cancelButtonText: 'Hủy'
        }).then((result) => {
            if (result.isConfirmed) {
                // Khi người dùng xác nhận, submit form
                document.getElementById("myForm").submit();
            }
        });
    }
</script>
</html>



















